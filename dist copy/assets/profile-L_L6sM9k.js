import{a as f}from"./authGuard-DDO8JLiG.js";import{b as u,h as p,U as h,C as T,P as o,c as g}from"./headers-ahJeJWcP.js";import{CreateMyPostsElements as S}from"./home-CRNFlK6L.js";import"./create-COmdal_b.js";async function y(){try{const e=JSON.parse(localStorage.getItem("user")),t=e?e.name:null;if(!t)throw new Error("User name not found in local storage.");const r=await fetch(`${u}${t}`,{method:"GET",headers:p()});if(!r.ok)throw console.error("HTTP error response:",r),new Error(`HTTP error! status: ${r.status||"unknown"}`);const n=(await r.json()).data||{};N(n)}catch(e){console.error("Error fetching profile:",e)}}function N(e){const t=document.getElementById("my-profile"),r=document.createElement("h2"),a=document.createElement("p"),n=document.createElement("p"),s=document.createElement("img"),c=document.createElement("img"),l=document.createElement("p"),i=document.createElement("p"),d=document.createElement("p");s.classList.add("profile-banner"),c.classList.add("profile-avatar"),t.appendChild(r),t.appendChild(a),t.appendChild(n),t.appendChild(s),t.appendChild(c),t.appendChild(l),t.appendChild(i),t.appendChild(d),r.innerHTML=e.name||"N/A",a.innerHTML=e.email||"N/A",n.innerHTML=e.bio||"N/A",s.src=e.banner&&e.banner.url?e.banner.url:"../../../ui/images/default-banner.jpg",c.src=e.avatar&&e.avatar.url?e.avatar.url:"../../../ui/images/default-avatar.jpg",l.innerHTML=e.posts?e.posts.length:0,i.innerHTML=e.followers?e.followers.length:0,d.innerHTML=e.following?e.following.length:0}function m(){o&&o.style.display==="block"&&(o.style.display="none")}function E(){o&&o.style.display==="none"&&(o.style.display="block")}h.addEventListener("click",E);T.addEventListener("click",m);o.style.display="none";f();async function w(){try{if(!localStorage.getItem("accessToken"))throw new Error("No access token found. Please log in.");const t=await fetch(g,{method:"GET",headers:p()});if(!t.ok)throw console.error("HTTP error response:",t),new Error(`HTTP error! status: ${t.status||"unknown"}`);const a=(await t.json()).data||[];localStorage.setItem("posts",JSON.stringify(a));const n=document.getElementById("my-posts-container");n&&(n.innerHTML="",a.forEach(s=>{try{new S(s,n)}catch(c){console.error("Error creating post elements:",c,s)}}))}catch(e){console.error("Error fetching posts:",e)}}y();w();E();m();export{w as getUserPosts};
